# 运动方程

## 最小作用量原理

任何一个力学系统可以用拉格朗日函数

$$
L(q_1,\cdots,q_s,\dot{q}_1,\cdots,\dot{q}_2,t)
$$

来描述，这个函数可以简记为：

$$
L(q,\dot{q},t)
$$

设系统在 $t=t_1 $ 时刻的位置为 $q^{(1)} $，在 $t=t_2 $ 时刻的位置为 $q^{(2)} $

作用量，记为 $S $，定义为拉格朗日函数对时间的积分：

$$
S[q(t)]
\equiv \int_{t_1}^{t_2} L(q,\dot{q},t)\mathrm{d}t
$$

作用量 $S $ 的值与 $q(t) $ 这一函数有关，一旦 $q(t) $ 这一函数确定，$S $ 的值也就确定。因此，$S $ 是一个泛函。

最小作用量原理就是说，使得作用量 $S $ 取平稳值的路径 $q(t) $ 是系统的真实运动路径。

### 运动方程的导出

考虑一个自由度为 $1 $ 的系统，系统的真实运动路径由广义坐标 $q(t) $ 描述。设函数 $q(t) $ 有一小变动 $(\delta q)(t) $，且函数 $(\delta q)(t) $ 满足：

$$
(\delta q)(t_1)=0,~~(\delta q)(t_2)=0
$$

作用量变为：

$$
\begin{aligned}
S[q(t)+(\delta q)(t)]
&=\int_{t_1}^{t_2} L\left(q(t)+(\delta q)(t),\frac{\mathrm{d}}{\mathrm{d}t}\bigg[q(t)+(\delta q)(t)\bigg],t \right) \mathrm{d}t \\
&=\int_{t_1}^{t_2} L\left(q(t)+(\delta q)(t),\dot{q}(t)+\dot{(\delta q)}(t),t \right) \mathrm{d}t \\
\end{aligned}
$$

将函数 $L\left(q+\delta q,\dot{q}+\dot{(\delta q)},t\right) $ 在 $(q,\dot{q},t) $ 处展开，忽略高阶小量：

$$
\begin{aligned}
L\left(q+\delta q,\dot{q}+\dot{(\delta q)},t\right)
&=L(q,\dot{q},t)+\frac{\partial L}{\partial q}\delta q+\frac{\partial L}{\partial \dot{q}}\dot{(\delta q)}\\
\end{aligned}
$$

作用量的变化为：

$$
\begin{aligned}
S[q(t)+(\delta q)(t)]-S[q(t)]
&=\int_{t_1}^{t_2} L\left(q(t)+(\delta q)(t),\dot{q}(t)+\dot{(\delta q)}(t),t \right) \mathrm{d}t - \int_{t_1}^{t_2} L\left(q(t),\dot{q}(t),t \right) \mathrm{d}t \\
&=\int_{t_1}^{t_2} \bigg[ \frac{\partial L}{\partial q}\delta q +\frac{\partial L}{\partial \dot{q}}\dot{(\delta q)} \bigg] \mathrm{d}t \\
&=\int_{t_1}^{t_2}\frac{\partial L}{\partial q}\delta q\mathrm{d}t+\int_{t_1}^{t_2}\frac{\partial L}{\partial \dot{q}}\frac{\mathrm{d}(\delta q) }{\mathrm{d}t }\mathrm{d}t \\
&=\int_{t_1}^{t_2}\frac{\partial L}{\partial q}\delta q\mathrm{d}t+\int_{t=t_1}^{t=t_2}\frac{\partial L }{\partial\dot{q} } \mathrm{d}(\delta q) \\
&=\int_{t_1}^{t_2}\frac{\partial L}{\partial q}\delta q\mathrm{d}t+\frac{\partial L }{\partial \dot{q} } \delta q\bigg|_{t=t_1}^{t=t_2}-\int_{t=t_1}^{t=t_2} \delta q \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}} \right) \mathrm{d}t \\
&=\int_{t_1}^{t_2}\frac{\partial L}{\partial q}\delta q\mathrm{d}t+0-\int_{t=t_1}^{t=t_2} \delta q \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}} \right) \mathrm{d}t \\
&=\int_{t_1}^{t_2} \bigg[ \frac{\partial L}{\partial q}-\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial \dot{q}} \right)  \bigg] \delta q\mathrm{d}t
\end{aligned}
$$

最小作用量原理说，系统的真实路径 $q(t) $ 使得作用量 $S $ 取平稳值。

这就是说，若 $q(t) $ 是系统的真实运动路径，则其上加一个任意的小变动 $(\delta q)(t) $ 导致的作用量的改变应为零，即系统的真实运动路径 $q(t) $ 应满足：

$$
S[q(t)+(\delta q)(t)]-S[q(t)]
=\int_{t_1}^{t_2} \bigg[ \frac{\partial L}{\partial q}-\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial \dot{q}} \right)  \bigg] \delta q\mathrm{d}t
=0
$$

由于 $(\delta q)(t) $ 的任意性，上式为零当且仅当：

$$
\frac{\partial L}{\partial q}-\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial \dot{q}} \right)
=0
$$

这就是运动方程（拉格朗日方程），其解 $q(t) $ 就是系统的真实运动路径。

对于有 $s $ 个自由度的系统，类似可得到 $s $ 个方程：

$$
\frac{\partial L}{\partial q_i}-\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial \dot{q}_i} \right)
=0,~~i=1,2,\cdots,s
$$


