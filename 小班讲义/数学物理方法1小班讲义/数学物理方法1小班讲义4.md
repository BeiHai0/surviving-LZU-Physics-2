[TOC]

# 第1章 $\R^3$ 空间的向量分析

## 向量分析基本知识

### 爱因斯坦求和约定

在同一代数项中见到两个重复指标 $i$ 就自动进行求和（除非特别指出该重复指标不求和），我们称求和指标 $i$ 为“哑标”。

比如，$\R^3 $ 空间中的向量 $\vec{A}\in \R^3 $ 在直角坐标下可表示为：

$$
\vec{A}
=A_1\vec{\mathrm{e}}_1+A_2\vec{\mathrm{e}}_2+A_3\vec{\mathrm{e}}_3
\equiv \sum_{i} A_i \vec{\mathrm{e}}_i
$$

其中，$\vec{\mathrm{e}}_1,\vec{\mathrm{e}}_2,\vec{\mathrm{e}}_3 $ 分别是 $x,y,z $ 轴正方向上的单位向量。

可利用爱因斯坦求和约定将 $\vec{A}\in \R^3 $ 简写为：

$$
\vec{A}
=\sum_{i} A_i \vec{\mathrm{e}}_i
\to
\vec{A}
=A_i \vec{\mathrm{e}}_i
$$

这样就省去了写求和符号的工作。 

### Kronecher delta 符号 $\delta_{ij} $

$$
\delta_{ij}
=\begin{cases}
1&,i=j \\
0&,i\ne j
\end{cases}
$$

### 三阶单位全反对称张量（三阶 Levi-Citita 符号）$\varepsilon_{ijk} $

$$
\varepsilon_{ijk}
=\begin{cases}
1&,ijk=123,231,312,即相邻两指标经过偶次对换能还原到123 \\
-1&,ijk=132,213,321,即相邻两指标经过奇次对换能还原到123 \\
0&,ijk中有相同指标 \\
\end{cases}
$$

可以利用 $\varepsilon_{ijk} $ 表示任何一个三阶行列式：

$$
\begin{vmatrix}
a_1 &a_2 &a_3 \\
b_1 &b_2 &b_3 \\
c_1 &c_2 &c_3
\end{vmatrix}
=\varepsilon_{ijk} a_i b_j c_k
$$

### 一些简单算例

$\vec{\mathrm{e}}_i\cdot\vec{\mathrm{e}}_j=\delta_{ij} $

$A_{i}\delta_{ij}=A_j $

$\vec{A}\cdot\vec{B}=A_i B_i $

$$
\vec{A}\cdot\vec{B}
=(A_i\vec{\mathrm{e}}_i)\cdot (B_j\vec{\mathrm{e}}_j)
=A_i B_j\vec{\mathrm{e}}_i\cdot \vec{\mathrm{e}}_j
=A_i B_j \delta_{ij}
=A_i B_i
$$

$\vec{A}\times\vec{B}=\varepsilon_{ijk}\vec{\mathrm{e}}_i A_j B_k $

$$
\vec{A}\times\vec{B}
=\begin{vmatrix}
\vec{\mathrm{e}}_1 &\vec{\mathrm{e}}_2 &\vec{\mathrm{e}}_3 \\
A_1 &A_2 &A_3 \\
B_1 &B_2 &B_3
\end{vmatrix}
=\varepsilon_{ijk} \vec{\mathrm{e}}_i A_j B_k
$$

### 梯度、散度、旋度

#### 梯度（gradient）的定义

设 $\psi(\vec{r}) $ 是标量场，$\psi(\vec{r}) $ 其梯度，记为 $\mathrm{grad}~\psi(\vec{r}) $，由下式定义：

$$
\mathrm{grad}~\psi(\vec{r})\cdot\mathrm{d}\vec{r}
=\mathrm{d}\psi(\vec{r})
$$

其中，$\mathrm{d}\vec{r} $ 是位矢 $\vec{r} $ 的微小变化，$\mathrm{d}\psi(\vec{r}) $ 是标量场 $\psi(\vec{r}) $ 因位矢 $\vec{r} $ 变化 $\mathrm{d}\vec{r} $ 而引起的相应的变化。具体来说，$\mathrm{d}\psi(\vec{r}) $ 的定义为：

$$
\mathrm{d}\psi(\vec{r})
\equiv \psi(\vec{r}+\mathrm{d}\vec{r})-\psi(\vec{r})
$$

#### 散度（divergence）的定义

向量场 $\vec{A} $ 的散度，记为 $\mathrm{div}~\vec{A} $，定义为：

$$
\mathrm{div}~\vec{A}
\equiv \lim_{V\to 0^+} \frac{1 }{V } \oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S}
$$

#### 旋度（curl）的定义

向量场 $\vec{A} $ 的旋度，记为 $\mathrm{curl}~\vec{A} $，由下式定义：

$$
\left(\mathrm{curl}~\vec{A} \right)\cdot \vec{n}
=\lim_{\sigma\to 0^+} \frac{1 }{\sigma } \oint\limits_{\partial \sigma^+} \vec{A}\cdot\mathrm{d}\vec{l}
$$

其中，$\sigma $ 是与 $\vec{n} $ 垂直的面元。$\vec{n} $ 与面元 $\sigma $ 的正绕行方向满足右手定则。

#### 直角坐标系下的梯度、散度、旋度

这里直接给出结论。

$$
\mathrm{grad}~\psi
=\vec{\mathrm{e}}_i\partial_i\psi
$$

$$
\mathrm{div}~\vec{A}
=\partial_i A_i
$$

$$
\mathrm{curl}~\vec{A}
=\varepsilon_{ijk}\vec{\mathrm{e}}_i \partial_j A_k
$$

#### $\nabla $ 算子

$\nabla $ 算子（nabla 算子，或 del 算子）定义为：

$$
\nabla
\equiv \vec{\mathrm{e}}_i\partial_i
$$

其中，$\partial_i $ 的定义为：

$$
\partial_i\equiv \frac{\partial }{\partial x_i} 
$$

利用 $\nabla $ 算子，可将梯度、散度、旋度表示为：

$$
\mathrm{grad}~\psi
=\vec{\mathrm{e}}_i\partial_i \psi
\equiv \nabla \psi
$$

$$
\mathrm{div}~\vec{A}
=\partial_i A_i
\equiv \nabla\cdot \vec{A}
$$

$$
\mathrm{curl}~\vec{A}
=\varepsilon_{ijk}\vec{\mathrm{e}}_i \partial_j A_k
\equiv \nabla\times \vec{A}
$$

为了书写方便，以后用 $\nabla\psi,\nabla\cdot\vec{A},\nabla\times\vec{A} $ 分别来指代梯度、散度、旋度。

### 梯度与方向导数的关系

#### 方向导数

标量场 $\psi $ 在 $\vec{r} $ 点处沿 $\vec{v} $ 方向的方向导数，记为 $\displaystyle{\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{v}}  }$，定义为：

$$
\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{v}}
\equiv \lim_{v\to 0^+} \frac{\psi(\vec{r} + \vec{v}) - \psi(\vec{r}) }{v } 
$$

特别地，标量场 $\psi $ 在曲面 $\Sigma $ 上的 $\vec{r} $ 点处沿曲面上 $\vec{r} $ 点的外法向的方向导数简记为：

$$
\frac{\partial\psi(\vec{r}) }{\partial n } 
$$

#### 梯度和方向导数的关系

标量场的梯度的定义：

$$
\nabla\psi\cdot\mathrm{d}\vec{r}
=\mathrm{d}\psi
$$

设 $\mathrm{d}\vec{r} = \vec{n} \mathrm{d}r $，其中 $\vec{n} $ 是与 $\mathrm{d}\vec{r} $ 同向的单位向量，则有：

$$
(\nabla\psi)\cdot\vec{n} \mathrm{d}r
=\mathrm{d}\psi
$$

即：

$$
(\nabla\psi)\cdot\vec{n}
=\frac{\mathrm{d}\psi }{\mathrm{d}r }
=\frac{\psi(\vec{r}+\mathrm{d}\vec{r}) - \psi(\vec{r}) }{\mathrm{d}r }
=\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{n}}   
$$

这就是说，标量场 $\psi $ 的梯度 $\nabla\psi $ 在某一方向 $\vec{n} $ 的投影恰等于标量场沿这一方向 $\vec{n} $ 的方向导数 $\displaystyle{\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{n}}  }$。

### 散度与高斯定理

从散度的定义

$$
\nabla\cdot\vec{A}
\equiv \lim_{V\to 0^+} \frac{1 }{V } \oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S}
$$

出发，可以导出高斯定理：

$$
\oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S}
=\int\limits_{V} (\nabla\cdot\vec{A})\mathrm{d}V
$$

### 旋度与斯托克斯定理

从旋度的定义

$$
\left(\nabla\times\vec{A} \right)\cdot \vec{n}
=\lim_{\sigma\to 0^+} \frac{1 }{\sigma } \oint\limits_{\partial \sigma^+} \vec{A}\cdot\mathrm{d}\vec{l}
$$

出发，可以导出斯托克斯定理：

$$
\oint\limits_{\partial\Sigma^+}\vec{A}\cdot\mathrm{d}\vec{l}
=\int\limits_{\Sigma} (\nabla\times\vec{A})\cdot\mathrm{d}\vec{S}
$$

## $\R^3 $ 空间中向量分析常用公式

### 分析工具

$$
\left\{
\begin{aligned}
&\vec{\mathrm{e}}_i\cdot\vec{\mathrm{e}}_j=\delta_{ij} \\
&\vec{A} = A_i\vec{\mathrm{e}}_i \\
&A_{i}\delta_{ij}=A_j \\
&\vec{A}\cdot\vec{B}=A_i B_i \\
&\vec{A}\times\vec{B}=\varepsilon_{ijk}\vec{\mathrm{e}}_i A_j B_k \\
&(\vec{A}\times\vec{B})_l = \varepsilon_{ljk} A_j B_k \\
&\nabla\psi = \vec{\mathrm{e}}_i\partial_i \\
&\nabla\cdot\vec{A}=\partial_i A_i \\
&\nabla\times\vec{A} = \varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j A_k \\
&\partial_i \psi = (\nabla\psi)_i \\
&\nabla^2 \equiv \nabla\cdot \nabla = \partial_i \partial_i \\
&\nabla^2\psi\equiv \nabla\cdot(\nabla\psi)=\partial_i\partial_i \psi \\
&\nabla^2\vec{A}\equiv (\nabla^2 A_i)\vec{\mathrm{e}}_i \\
&\varepsilon_{ijk} = \varepsilon_{jki} = \varepsilon_{kij} \\
&\varepsilon_{ijk}\varepsilon_{ilm} = \delta_{jl}\delta_{km} - \delta_{jm}\delta_{kl} \\
&\partial_i x_j = \delta_{ij}
\end{aligned}
\right.
$$

### $\R^3 $ 空间中重要微分恒等式

#### 与 $\vec{r} $ 有关的公式

> $\nabla\cdot\vec{r}=3 $

$$
\begin{aligned}
\nabla\cdot\vec{r}
=\partial_i x_i
=3
\end{aligned}
$$

> $\nabla\times\vec{r}=\vec{0} $

$$
\begin{aligned}
\nabla\times\vec{r}
=\varepsilon_{ijk}\vec{\mathrm{e}}_i\partial_j x_k
=\varepsilon_{ijk}\vec{\mathrm{e}}_i \delta_{jk}
=\vec{0}
\end{aligned}
$$

#### 从左往右证的公式

> $\nabla(\varphi\psi)=\varphi\nabla\psi+\psi\nabla\varphi $

$$
\begin{aligned}
\nabla(\varphi\psi)
&=\vec{\mathrm{e}}_i\partial_i(\varphi\psi) \\
&=\vec{\mathrm{e}}_i\varphi\partial_i\psi + \vec{\mathrm{e}}_i\psi\partial_i\varphi \\
&=\varphi\vec{\mathrm{e}}_i\partial_i\psi + \psi\vec{\mathrm{e}}_i\partial_i\varphi \\
&=\varphi\nabla\psi + \psi\nabla\varphi
\end{aligned}
$$

> $\nabla\cdot(\varphi\vec{A})=\vec{A}\cdot(\nabla\varphi) + \varphi\nabla\cdot\vec{A} $

$$
\begin{aligned}
\nabla\cdot(\varphi\vec{A})
&=\partial_i(\varphi \vec{A})_i \\
&=\partial_i(\varphi A_i) \\
&=\varphi\partial_i A_i + A_i\partial_i \varphi \\
&=\varphi\nabla\cdot\vec{A} + (\vec{A}\cdot\nabla)\varphi \\
&=(\vec{A}\cdot\nabla)\varphi + \varphi\nabla\cdot\vec{A}
\end{aligned}
$$

> $\nabla\times(\varphi\vec{A})=(\nabla\varphi)\times\vec{A} + \varphi \nabla\times\vec{A} $

$$
\begin{aligned}
\nabla\times(\varphi\vec{A})
&=\varepsilon_{ijk}\vec{\mathrm{e}}_i\partial_j (\varphi\vec{A})_k \\
&=\varepsilon_{ijk}\vec{\mathrm{e}}_i \partial_j(\varphi A_k) \\
&=\varepsilon_{ijk}\vec{\mathrm{e}}_i (A_k\partial_j \varphi + \varphi\partial_j A_k) \\
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i(\nabla\varphi)_j A_k + \varphi \varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j A_k \\
&=(\nabla\varphi)\times \vec{A} + \varphi \nabla\times\vec{A}
\end{aligned}
$$

> $\nabla\cdot (\vec{A}\times\vec{B} )=\vec{B}\cdot(\nabla\times\vec{A})-\vec{A}\cdot(\nabla\times\vec{B}) $

$$
\begin{aligned}
\nabla\cdot (\vec{A}\times\vec{B} )
&=\partial_i (\vec{A}\times\vec{B})_i \\
&=\partial_i (\varepsilon_{ijk} A_j B_k) \\
&=\varepsilon_{ijk}\partial_i ( A_j B_k) \\
&=\varepsilon_{ijk} B_k\partial_i A_j + \varepsilon_{ijk} A_j \partial_i B_k \\
&=B_k \varepsilon_{kij} \partial_i A_j - A_j \varepsilon_{jik} \partial_i B_k \\
&=B_k (\nabla\times \vec{A})_k - A_j (\nabla\times \vec{B})_j \\
&=\vec{B}\cdot(\nabla\times \vec{A}) - \vec{A}\cdot(\nabla\times\vec{B})
\end{aligned}
$$

> $\nabla\times(\vec{A}\times\vec{B}) = (\vec{B}\cdot\nabla)\vec{A} - (\vec{A}\cdot\nabla) \vec{B} + \vec{A}(\nabla\cdot\vec{B}) - \vec{B}(\nabla\cdot\vec{A}) $

$$
\begin{aligned}
\nabla\times(\vec{A}\times\vec{B})
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j (\vec{A}\times\vec{B})_k \\
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j \varepsilon_{klm} A_l B_m \\
&=\varepsilon_{kij} \varepsilon_{klm} \vec{\mathrm{e}}_i \partial_j (A_l B_m) \\
&=(\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \vec{\mathrm{e}}_i (B_m\partial_j A_l + A_l\partial_j B_m) \\
&=\vec{\mathrm{e}}_l B_j\partial_j A_l + \vec{\mathrm{e}}_l A_l \partial_m B_m - \vec{\mathrm{e}}_m B_m \partial_l A_l - \vec{\mathrm{e}}_m A_j\partial_j B_m \\
&= B_j\partial_j A_l\vec{\mathrm{e}}_l + \vec{\mathrm{e}}_l A_l \partial_m B_m - \vec{\mathrm{e}}_m B_m \partial_l A_l -  A_j\partial_j B_m \vec{\mathrm{e}}_m \\
&=(\vec{B}\cdot\nabla)\vec{A} + \vec{A}(\nabla\cdot\vec{B}) - \vec{B}(\nabla\cdot\vec{A}) - (\vec{A}\cdot\nabla) \vec{B} \\
&=(\vec{B}\cdot\nabla)\vec{A} - (\vec{A}\cdot\nabla) \vec{B} + \vec{A}(\nabla\cdot\vec{B}) - \vec{B}(\nabla\cdot\vec{A})
\end{aligned} 
$$

> $\nabla\times(\nabla\times\vec{A})=\nabla(\nabla\cdot\vec{A})-\nabla^2 \vec{A} $

$$
\begin{aligned}
\nabla\times(\nabla\times\vec{A})
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i\partial_j (\nabla\times\vec{A})_k \\
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j \varepsilon_{klm} \partial_l A_m \\
&=\varepsilon_{kij}\varepsilon_{klm} \vec{\mathrm{e}}_i\partial_j\partial_l A_m \\
&=(\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \vec{\mathrm{e}}_i \partial_j \partial_l A_m \\
&=\vec{\mathrm{e}}_l\partial_m \partial_l A_m - \vec{\mathrm{e}}_m\partial_l \partial_l A_m \\
&=\vec{\mathrm{e}}_l\partial_l\partial_m A_m -\partial_l\partial_l A_m\vec{\mathrm{e}}_m \\
&=\nabla(\nabla\cdot\vec{A}) - \nabla^2\vec{A}
\end{aligned}
$$

#### 需要注意力的公式

> $\nabla\times(\nabla \varphi)=\vec{0} $

$$
\begin{aligned}
\nabla\times(\nabla \varphi)
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i\partial_j (\nabla\varphi)_k \\
&=\vec{\mathrm{e}}_i\varepsilon_{ijk} \partial_j\partial_k\varphi
\end{aligned}
$$

由于我们只考虑性质比较好的函数，于是 $\partial_j \partial_k\varphi=\partial_k\partial_j\varphi $，再结合 $\varepsilon_{ijk}=-\varepsilon_{ikj} $，有：

$$
\begin{aligned}
\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi
&=-\vec{\mathrm{e}}_i\varepsilon_{ikj}\partial_k\partial_j\varphi \\
&=-\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi
\end{aligned}
$$

最后一步是因为 $j,k $ 都是用于求和的哑标，因此可以交换。

上式说明：

$$
\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi=\vec{0}
$$

于是：

$$
\nabla\times(\nabla \varphi)
=\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi
=\vec{0}
$$

> $\nabla\cdot(\nabla\times \vec{A})=0 $

$$
\begin{aligned}
\nabla\cdot(\nabla\times \vec{A})
&=\partial_i (\nabla\times\vec{A})_i \\
&=\partial_i \varepsilon_{ijk} \partial_j A_k \\
&=\varepsilon_{ijk}\partial_i\partial_j A_k
\end{aligned}
$$

注意到：

$$
\begin{aligned}
\varepsilon_{ijk}\partial_i\partial_j A_k
&=-\varepsilon_{jik}\partial_j\partial_i A_k \\
&=-\varepsilon_{ijk}\partial_i\partial_j A_k
\end{aligned}
$$

于是：

$$
\varepsilon_{ijk}\partial_i\partial_j A_k
=0
$$

这就是说：

$$
\nabla\cdot(\nabla\times \vec{A})
=\varepsilon_{ijk}\partial_i\partial_j A_k
=0
$$

#### 从右往左证的公式

> $\nabla(\vec{A}\cdot\vec{B})=(\vec{B}\cdot \nabla)\vec{A}+(\vec{A}\cdot\nabla)\vec{B}+\vec{B}\times(\nabla\times\vec{A})+\vec{A}\times(\nabla\times\vec{B}) $

$$
\begin{aligned}
&(\vec{B}\cdot \nabla)\vec{A}+(\vec{A}\cdot\nabla)\vec{B}+\vec{B}\times(\nabla\times\vec{A})+\vec{A}\times(\nabla\times\vec{B}) \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \varepsilon_{ijk}\vec{\mathrm{e}}_iB_j(\nabla\times\vec{A})_k + \varepsilon_{ijk} \vec{\mathrm{e}}_i A_j(\nabla\times\vec{B})_k \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \varepsilon_{ijk}\vec{\mathrm{e}}_iB_j\varepsilon_{klm}\partial_l A_m + \varepsilon_{ijk} \vec{\mathrm{e}}_i A_j\varepsilon_{klm}\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \varepsilon_{kij}\varepsilon_{klm}\vec{\mathrm{e}}_iB_j\partial_l A_m + \varepsilon_{kij}\varepsilon_{klm} \vec{\mathrm{e}}_i A_j\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + (\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl})\vec{\mathrm{e}}_iB_j\partial_l A_m + (\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \vec{\mathrm{e}}_i A_j\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \vec{\mathrm{e}}_l B_m\partial_l A_m -\vec{\mathrm{e}}_m B_l\partial_l A_m + \vec{\mathrm{e}}_l A_m\partial_l B_m - \vec{\mathrm{e}}_m A_l\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j +  B_m\vec{\mathrm{e}}_l\partial_l A_m -B_l\partial_l A_m \vec{\mathrm{e}}_m + A_m\vec{\mathrm{e}}_l \partial_l B_m -  A_l\partial_l B_m \vec{\mathrm{e}}_m \\
=&B_m\vec{\mathrm{e}}_l\partial_l A_m + A_m\vec{\mathrm{e}}_l \partial_l B_m \\
=&B_m\nabla A_m + A_m \nabla B_m \\
=&\nabla(A_m B_m) \\
=&\nabla(\vec{A}\cdot\vec{B})
\end{aligned}
$$

### $\R^3 $ 空间中重要积分恒等式

#### 高斯定理

> $\displaystyle{\oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S} = \int\limits_{V} (\nabla\cdot\vec{A})\mathrm{d}V}$ 

#### 斯托克斯定理

> $\displaystyle{\oint\limits_{\partial\Sigma^+}\vec{A}\cdot\mathrm{d}\vec{l} = \int\limits_{\Sigma} (\nabla\times\vec{A})\cdot\mathrm{d}\vec{S} }$ 

#### 格林第一恒等式

> $\displaystyle{\oint\limits_{\partial\Omega^+} \psi\nabla\phi\cdot\mathrm{d}\vec{S} = \int\limits_{\Omega} \left(\psi\nabla^2\phi + \nabla\phi\cdot \nabla\psi \right)\mathrm{d}V }$

注意到：

$$
\begin{aligned}
\nabla\cdot(\psi\nabla\phi)
&=\partial_i(\psi\nabla\phi)_i \\
&=\partial_i(\psi\partial_i\phi) \\
&=(\partial_i \phi)(\partial_i\psi) + \psi\partial_i\partial_i\phi \\
&=(\nabla\phi)_i(\nabla\psi)_i + \psi\nabla^2\phi \\
&=(\nabla\phi)\cdot(\nabla\psi) + \psi\nabla^2\phi
\end{aligned}
$$

于是由高斯定理，有：

$$
\begin{aligned}
\oint\limits_{\partial\Omega^+} \psi\nabla\phi\cdot\mathrm{d}\vec{S}
&=\int\limits_{\Omega} \nabla\cdot(\psi\nabla\phi)\mathrm{d}V \\
&=\int\limits_{\Omega} \left[(\nabla\phi)\cdot(\nabla\psi) + \psi\nabla^2\phi \right]\mathrm{d}V \\
&=\int\limits_{\Omega} \left[\psi\nabla^2\phi + (\nabla\phi)\cdot(\nabla\psi) \right]\mathrm{d}V \\
\end{aligned}
$$

#### 格林第二恒等式

> $\displaystyle{\oint\limits_{\partial\Omega^+}\left(\psi\nabla\phi-\phi\nabla\psi \right)\cdot\mathrm{d}\vec{S} = \int\limits_{\Omega} (\psi\nabla^2\phi-\phi\nabla^2\psi)\mathrm{d}V} $ 

利用 $\nabla\cdot(\varphi\vec{A})=\vec{A}\cdot(\nabla\varphi) + \varphi\nabla\cdot\vec{A} $ 可得：

$$
\begin{aligned}
\nabla\cdot(\psi\nabla\phi-\phi\nabla\psi)
&=\nabla\phi\cdot\nabla\psi + \psi\nabla\cdot(\nabla\phi) - \left(\nabla\psi\cdot\nabla\phi + \phi\nabla\cdot(\nabla\psi) \right) \\
&=\psi\nabla^2\phi-\phi\nabla^2\psi
\end{aligned}
$$

于是由高斯定理可得：

$$
\begin{aligned}
\oint\limits_{\partial\Omega^+}\left(\psi\nabla\phi-\phi\nabla\psi \right)\cdot\mathrm{d}\vec{S}
&=\int\limits_{\Omega} \nabla\cdot(\psi\nabla\phi-\phi\nabla\psi) \mathrm{d}V \\
&=\int\limits_{\Omega} (\psi\nabla^2\phi-\phi\nabla^2\psi) \mathrm{d}V
\end{aligned}
$$



# 第2章 $\R^3$ 空间曲线坐标系中的向量分析

## $\nabla$ 算子

### 直角坐标下的 $\nabla$

$$
\nabla
=\vec{e}_x\frac{\partial }{\partial x}+\vec{e}_y\frac{\partial}{\partial y}+\vec{e}_z\frac{\partial }{\partial z}
$$

### 球坐标下的 $\nabla$

$$
\nabla
=\vec{e}_r\frac{\partial }{\partial r}+\vec{e}_\theta\frac{1}{r}\frac{\partial}{\partial \theta} +\vec{e}_\varphi \frac{1}{r\sin\theta}\frac{\partial}{\partial \varphi}
$$

### 柱坐标下的 $\nabla$

$$
\nabla
=\vec{e}_\rho\frac{\partial}{\partial \rho}+\vec{e}_\varphi\frac{1}{\rho} \frac{\partial}{\partial \varphi}+\vec{e}_z\frac{\partial}{\partial z}
$$

## $\nabla^2$ 算子

### 直角坐标下的 $\nabla^2$

$$
\nabla^2
=\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}+\frac{\partial^2}{\partial z^2}
$$

### 球坐标下的 $\nabla^2$

$$
\nabla^2
=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)+\frac{1}{r^2\sin\theta}\frac{\partial}{\partial \theta}\left(\sin\theta\frac{\partial}{\partial\theta}\right)+\frac{1}{r^2\sin^2\theta}\frac{\partial^2}{\partial \varphi^2}
$$

### 柱坐标下的 $\nabla^2$

$$
\nabla^2
=\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2}+\frac{\partial^2}{\partial z^2}
$$

# 第3章 线性空间

# 第4章 复变函数的概念

## 欧拉公式

$$
\mathrm{e}^{\mathrm{i}\theta}
=\cos\theta + \mathrm{i}\sin\theta,~~\theta\in \mathbb{C}
$$

## 复变函数

复变函数是黎曼面到复平面的映射，即：

$$
f(z):\mathbb{C}^{\mathrm{R}}\to \mathbb{C}
$$

### 常见复变函数

#### 有理函数

$$
f(z)
=\frac{a_0 + a_1 z + \cdots + a_n z^n }{b_0 + b_1 z + \cdots +b_n z^n },~~a_i,b_i\in \mathbb{C},~~m,n\in \Z 
$$

#### 指数函数

$$
f(z)
=\mathrm{e}^{z}
$$

#### 对数函数

$$
f(z)
=\ln z
$$

#### 幂函数

$$
f(z)
=z^a,~~a\in \mathbb{C}
$$

#### 三角函数

$$
\cos z
\equiv \frac{\mathrm{e}^{\mathrm{i}z} + \mathrm{e}^{-\mathrm{i}z} }{2 } 
$$

$$
\sin z
\equiv \frac{\mathrm{e}^{\mathrm{i}z} - \mathrm{e}^{-\mathrm{i}z} }{2\mathrm{i} } 
$$

性质：

$$
\cos(-z) = \cos(z),~~
\cos(z+2\pi) = \cos(z)
$$

$$
\sin(-z) = -\sin (z),~~
\sin(z+2\pi) = \sin(z)
$$

$$
\sin^2 z + \cos^2 z = 1
$$

$|\cos z|,|\sin z| $ 可以大于 $1 $，这与实三角函数不同。

####  双曲函数

$$
\cosh z
\equiv \frac{\mathrm{e}^{z} + \mathrm{e}^{-z} }{2 } 
$$

$$
\sinh z
\equiv \frac{\mathrm{e}^{z} - \mathrm{e}^{-z} }{2 } 
$$

$$
\tanh z
\equiv \frac{\sinh z }{\cosh z }
=\frac{\mathrm{e}^{z} - \mathrm{e}^{-z} }{\mathrm{e}^{z} + \mathrm{e}^{-z} } 
$$

双曲函数与三角函数的关系：

$$
\sinh z
=-\mathrm{i}\sin(\mathrm{i}z)
$$

$$
\cosh z
=\cos(\mathrm{i}z)
$$

双曲函数的性质：

$$
\sinh (z+\mathrm{i}2\pi)
=\sinh z
$$

$$
\cosh(z+\mathrm{i}2\pi)
=\cosh z
$$

$$
\cosh(-z)
=\cosh z
$$

$$
\sinh(-z)
=-\sinh z
$$

$$
\cosh^2 z - \sinh^2 z
=1
$$

# 第5章 解析函数

## 复变函数的导数

### 复变函数的连续性

复变函数 $f(z)$ 在 $z_0$ 点及其邻域内有定义。当自变量 $z$ 以任何路径趋于 $z_0$ 时，都有：

$$
\lim_{z\to z_0} f(z)
=f(z_0)
$$

则称 $f(z)$ 在 $z_0$ 点连续。

若 $f(z)$ 在区域 $\Omega$ 内的所有点都连续，则称 $f(z)$ 在 $\Omega$ 内连续。

### 复变函数的导数

当 $z$ 以任何路径趋于 $z_0$ 时，即 $\Delta z=z-z_0$ 以任何方式趋于 $0$ 时，若极限：

$$
\lim_{\Delta z\to 0}\frac{f(z_0+\Delta z)-f(z_0)}{\Delta z}
$$

存在且唯一，则称 $f(z)$ 在 $z_0$ 点可导，$f(z)$ 在 $z_0$ 点的导数记为 $f'(z_0)$

### 柯西-黎曼条件

设复变函数 $f(z)=u(x,y)+\mathrm{i}v(x,y)$，若 $f(z)$ 在 $z$ 点可导，则必定有：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v}{\partial y},
\frac{\partial u}{\partial y}
=-\frac{\partial v}{\partial x}
$$

**上面两条等式**就是**柯西-黎曼条件(C-R条件)**。

### 命题的证明

设 $z=x+\mathrm{i} y,f(z)=u(x,y)+\mathrm{i}v(x,y)$，则：

$$
\lim_{\Delta z\to 0} \frac{f(z+\Delta z)-f(z)}{\Delta z}
=\lim_{\Delta z\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x+\mathrm{i}\Delta y}
$$

由于 $f(z)$ 在 $z$ 点可导，故极限

$$
\lim_{\Delta z\to 0} \frac{f(z+\Delta z)-f(z)}{\Delta z}
$$

存在且与 $\Delta z$ 趋于 $0$ 的方式无关。

特别地，

（1）令：

$$
\mathrm{i}\Delta y=0,\Delta x\to 0
$$

此时，

$$
\lim_{\Delta z\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x+\mathrm{i}\Delta y}
=\lim_{\Delta x\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x}
=\frac{\partial u}{\partial x}+\mathrm{i}\frac{\partial v}{\partial x}
$$

（2）令：

$$
\Delta x=0,\mathrm{i}\Delta y\to0
$$

此时，

$$
\lim_{\Delta z\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x+\mathrm{i}\Delta y}
=-\mathrm{i}\frac{\partial u}{\partial y}+\frac{\partial v}{\partial y}
$$

由于 $f(z)$ 在 $z_0$ 点可导，则这两个导数值应该相等，于是：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v}{\partial y}
,\frac{\partial u}{\partial y}
=-\frac{\partial v}{\partial x}
$$

C-R 条件是 $f(z) $ 在 $z $ 点可导的必要条件，但不是充分条件。也就是说，可导必定满足 C-R 条件，但满足 C-R 条件不一定可导。

## 复变函数的解析性

### 复变函数的解析性

若复变函数 $f(z)$ 在 $z_0$ 的邻域内每一点都可导，则称 $f(z)$ 在 $z_0$ 点是**解析的**。

若复变函数 $f(z)$ 在 $\Omega$ 内每一点都可导，则 $f(z)$ 在 $\Omega$ 内是**解析的**，或称为**全纯的**。

### 相关定理

#### 定理1

复变函数 $f(z) = u(x,y) + \mathrm{i} v(x,y) $ 在区域 $\Omega $ 为解析函数 $\Longleftrightarrow $ 在与复平面 $\Omega $ 相应的实平面区域内 $u(x,y),v(x,y) $ 可微，且 $u(x,y),v(x,y) $ 满足 C-R 条件。

特别地，若 $f(z) $ 为 $\Omega $ 上的连续函数，则 $f(z) $ 是 $\Omega $ 上的解析函数 $\Longleftrightarrow $ $f(z) $ 满足 C-R 条件。

#### 定理2

若 $f(z) $ 为区域 $\Omega $ 上的解析函数，且 $f(z) $ 为实函数，即 $f(z)=f^*(z) $，则 $f(z) $ 为常数。

#### 定理3

若 $f(z) $ 为区域 $\Omega $ 上的解析函数，则在 $\Omega $ 上有 $\displaystyle{\frac{\partial f(z,z^*) }{\partial z }=0 }$，即 $f(z,z^*) $ 不依赖于 $z^* $ 

#### 定理4

在复平面区域 $\Omega $ 内解析的函数 $f(z)=u(x,y)+\mathrm{i}v(x,y) $，其实部 $u(x,y) $ 和虚部 $v(x,y) $ 都是平面区域 $\Omega $ 内的调和函数（即满足二维拉普拉斯方程 $\displaystyle{\nabla^2 u(x,y)=0,\nabla^2 v(x,y)=0 }$ 的函数）。

## 例题

### 例1

> 已知解析函数的实部 $u=x^3-3xy^2 $，求该解析函数。

#### 方法1（积分法）

$$
f(z)
=u(x,y)+\mathrm{i}v(x,y)
$$

解析函数应满足柯西-黎曼条件：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v}{\partial y},~~
\frac{\partial u}{\partial y}
=-\frac{\partial v}{\partial x}
$$

$$
\frac{\partial v}{\partial y}
=\frac{\partial u }{\partial x } 
=3x^2-3y^2,~~
\frac{\partial v}{\partial x}
=-\frac{\partial u }{\partial y } 
=6xy
$$

$$
\mathrm{d}v(x,y)
=\frac{\partial v }{\partial x }\mathrm{d}x + \frac{\partial v }{\partial y } \mathrm{d}y
=6xy\mathrm{d}x+(3x^2-3y^2)\mathrm{d}y \tag{1}
$$

选择积分路径为：$\underbrace{(0,0)\to(x,0)}_{C_1},\underbrace{(x,0)\to(x,y)}_{C_2}$，两边积分：

$$
\begin{aligned}
v(x,y)-v(0,0)
&=\int\limits_{C_1} 6xy\mathrm{d}x+(3x^2-3y^2)\mathrm{d}y+\int\limits_{C_2}6xy\mathrm{d}x+(3x^2-3y^2)\mathrm{d}y \\
&=0+\int_{y=0}^{y=y}(3x^2-3y^2)\mathrm{d}y \\
&=3x^2 y-y^3
\end{aligned}
$$

令 $v(0,0)=C$，则：

$$
v(x,y)
=3x^2y-y^3+v(0,0)
=3x^2y-y^3+C
$$

于是：

$$
\begin{aligned}
f(z)
&=u(x,y)+\mathrm{i}v(x,y) \\
&=x^3-3xy^2+\mathrm{i}(3x^2 y-y^3+C)
\end{aligned}
$$

### 例2

> 请证明：柱坐标系下的解析函数 $f(z)=u(\rho,\varphi) + \mathrm{i} v(\rho,\varphi) $ 满足的 C-R 方程：
>
>$$
\left\{
\begin{aligned}
&\frac{\partial u }{\partial \rho } = \frac{1 }{\rho } \frac{\partial v }{\partial \varphi } \\
&\frac{1 }{\rho } \frac{\partial u }{\partial \varphi } = -\frac{\partial v }{\partial \rho } 
\end{aligned}
\right.
>$$

直角坐标下的 C-R 条件：

$$
\frac{\partial u }{\partial x } 
=\frac{\partial v }{\partial y },~~
\frac{\partial u }{\partial y }
=-\frac{\partial v }{\partial x } 
$$

$$
\left\{
\begin{aligned}
&x=\rho\cos\varphi \\
&y=\rho\sin\varphi
\end{aligned}
\right.
\Longrightarrow
\left\{
\begin{aligned}
&\rho = \sqrt{x^2+y^2} \\
&\tan \varphi = \frac{y }{x } 
\end{aligned}
\right.
$$

注意到：

$$
\begin{aligned}
\frac{\partial u }{\partial x }
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial u }{\partial \varphi } \frac{\partial \varphi }{\partial x } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial u }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial u }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial u }{\partial \rho }\frac{x }{\sqrt{x^2+y^2} } + \frac{\partial u }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(-\frac{y }{x^2 }  \right) \\
&=\frac{\partial u }{\partial \rho } \cos\varphi + \frac{\partial u }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right)
\end{aligned}
$$

$$
\begin{aligned}
\frac{\partial u }{\partial y }
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial u }{\partial \varphi } \frac{\partial \varphi }{\partial y } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial u }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial u }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial u }{\partial \rho }\frac{y }{\sqrt{x^2+y^2} } + \frac{\partial u }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(\frac{1 }{x }   \right) \\
&=\frac{\partial u }{\partial \rho }\sin\varphi + \frac{\partial u }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right)
\end{aligned}
$$

$$
\begin{aligned}
\frac{\partial v }{\partial x }
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial v }{\partial \varphi } \frac{\partial \varphi }{\partial x } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial v }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial v }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial v }{\partial \rho }\frac{x }{\sqrt{x^2+y^2} } + \frac{\partial v }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(-\frac{y }{x^2 }  \right) \\
&=\frac{\partial v }{\partial \rho } \cos\varphi + \frac{\partial v }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right)
\end{aligned}
$$

$$
\begin{aligned}
\frac{\partial v }{\partial y }
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial v }{\partial \varphi } \frac{\partial \varphi }{\partial y } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial v }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial v }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial v }{\partial \rho }\frac{y }{\sqrt{x^2+y^2} } + \frac{\partial v }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(\frac{1 }{x }   \right) \\
&=\frac{\partial v }{\partial \rho }\sin\varphi + \frac{\partial v }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right)
\end{aligned}
$$

全部代入直角坐标下的 C-R 方程：

$$
\frac{\partial u }{\partial \rho } \cos\varphi + \frac{\partial u }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right) 
=\frac{\partial v }{\partial \rho }\sin\varphi + \frac{\partial v }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right) \tag{1}
$$

$$
\frac{\partial u }{\partial \rho }\sin\varphi + \frac{\partial u }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right)
=-\left[\frac{\partial v }{\partial \rho } \cos\varphi + \frac{\partial v }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right) \right] \tag{2}
$$

$(1)\times\cos\varphi + (2)\times \sin\varphi $ 得到：

$$
\frac{\partial u }{\partial \rho }
=\frac{1 }{\rho } \frac{\partial v }{\partial \varphi } 
$$

$(2)\times \cos\varphi - (1)\times \sin\varphi $ 得到：

$$
\frac{1 }{\rho } \frac{\partial u }{\partial \varphi } 
=-\frac{\partial v }{\partial \rho } 
$$

### 例3

> 已知解析函数的虚部 $\displaystyle{v=\frac{y }{x^2+y^2 }  }$ ，求该解析函数。

$$
\frac{\partial v}{\partial x}
=\frac{-2xy}{\left(x^2+y^2\right)^2},
\frac{\partial v}{\partial y}
=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}
$$

函数解析，故满足 C-R 条件，即满足：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v }{\partial y } 
=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}
$$

$$
\frac{\partial u}{\partial y}
=-\frac{\partial v }{\partial x } 
=\frac{2xy}{\left(x^2+y^2\right)^2}
$$

于是：

$$
\begin{aligned}
\mathrm{d}u
&=\frac{\partial u }{\partial x } \mathrm{d}x + \frac{\partial u }{\partial y } \mathrm{d}y \\
&=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}\mathrm{d}x+\frac{2xy}{\left(x^2+y^2\right)^2}\mathrm{d}y \\
\end{aligned}
$$

极坐标变换：

$$
\left\{
\begin{aligned}
&x=\rho\cos\varphi \\
&y=\rho\sin\varphi
\end{aligned}
\right.
\Longrightarrow
\left\{
\begin{aligned}
&\mathrm{d}x = \frac{\partial x }{\partial \rho } \mathrm{d}\rho + \frac{\partial x }{\partial \varphi } \mathrm{d}\varphi = \cos\varphi\mathrm{d}\rho - \rho \sin\varphi \mathrm{d}\varphi \\
&\mathrm{d}y = \frac{\partial y }{\partial \rho } \mathrm{d}\rho + \frac{\partial y }{\partial \varphi } \mathrm{d}\varphi = \sin\varphi \mathrm{d}\rho + \rho\cos\varphi \mathrm{d}\varphi
\end{aligned}
\right.
$$

于是：

$$
\begin{aligned}
\mathrm{d}u
&=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}\mathrm{d}x+\frac{2xy}{\left(x^2+y^2\right)^2}\mathrm{d}y \\
&=\frac{\cos\varphi }{\rho^2 } \mathrm{d}\rho + \frac{\sin\varphi }{\rho } \mathrm{d}\varphi \\
&=\mathrm{d}\left(\frac{-\cos\varphi }{\rho }  \right)
\end{aligned}
$$

于是：

$$
u
=\frac{-\cos\varphi }{\rho } + C
=-\frac{x }{x^2+y^2 } + C
$$

综上，

$$
\begin{aligned}
f(z)
&=u + \mathrm{i} v \\
&=\left(-\frac{x }{x^2+y^2 } + C \right) + \mathrm{i}\left(\frac{y }{x^2+y^2 } \right)
\end{aligned}
$$


# 第6章 复变函数积分

## 复变函数积分

### 复变函数积分的定义

复变函数的积分是指复变函数 $f(z)$ 在其有定义的区域 $\Omega$ 中，沿某一曲线 $C$ 的**有向**的**线积分**，记为 $\int\limits_{C} f(z)\mathrm{d}z$，其定义为：

$$
\int\limits\limits_C f(z)\mathrm{d}z
=\lim\limits_{\substack{n\to \infty \\ |z_j-z_{j-1}|\to 0 }}\sum\limits_{j=1}^{n} f(\xi_j) (z_j-z_{j-1})
$$

把 $C $ 分成 $n $ 段，$\xi_j $ 是 $C $ 上 $z_{j-1} $ 点到 $z_j $ 点的中的某一点。

### 复变函数积分的性质

$$
\left|\int\limits_{C} f(z)\mathrm{d}z \right|
\leqslant \int\limits_{C} \left| f(z) \right|\left|\mathrm{d}z \right|
$$

## 柯西积分定理

### 单连通区域柯西积分定理

设 $f(z)$ 在单连通区域 $\Omega$ 上解析，当积分路径为 $\Omega$ 内的任一闭合曲线 $C$ 时，有： 

$$
\oint\limits_{C^+} f(z)\mathrm{d}z
=0
$$

### 多连通区域的柯西积分定理

设 $f(z)$ 在具有 $k$ 个内边界 $C_1,C_2,\cdots,C_k$ 的回路 $C$ 内的复连通区域内解析，规定 $C;C_1,C_2,\cdots,C_k $ 的正方向为逆时针，则：

$$
\oint\limits_{C^+} f(z)\mathrm{d}z
=\oint\limits_{C_1^+} f(z)\mathrm{d}z+\oint\limits_{C_2^+} f(z)\mathrm{d}z+\cdots+\oint\limits_{C_k^+} f(z)\mathrm{d}z
$$

## 柯西积分公式

若 $f(z)$ 在闭合回路 $C$ 所包围的区域上解析，$z_0$ 是此区域中的一点，则：

$$
\oint\limits_{C^+}\frac{f(z)}{z-z_0}\mathrm{d}z
=2\pi \mathrm{i} f(z_0)
$$

## 解析函数高阶导数的积分表达式

设 $f(z)$ 在区域 $\Omega$ 内解析，$C$ 为 $\Omega$ 内的任一闭合回路，对于 $C$ 所包围的区域内的任一点 $z$，有：

$$
f^{(n)}(z)
\equiv \frac{\mathrm{d}^n }{\mathrm{d}z^n }f(z) 
=\frac{n!}{2\pi\mathrm{i}}\oint\limits_{C^+} \frac{f(\zeta)}{(\zeta-z)^{n+1}}\mathrm{d}\zeta
$$

# 第7章 复变函数的级数展开

## 解析函数的泰勒展开

设 $z_0$ 为函数 $f(z)$ 解析区域 $\Omega$ 内的一点，以 $z_0$ 为圆心的圆周 $C$ 在 $\Omega$ 内，则 $f(z)$ 可以在 $C$ 内展成泰勒级数：

$$
f(z)
=\sum_{n=0}^{\infty} a_n(z-z_0)^n
$$

其中，展开系数为：

$$
a_n
=\frac{f^{(n)}(z_0)}{n!}
=\frac{1}{2\pi \mathrm{i}}\oint\limits_{C^+} \frac{f(z)}{(z-z_0)^{n+1}}\mathrm{d}z
$$

## 解析函数的洛朗展开

### 复变函数的零点

若复变函数 $f(z) $ 在 $z_0 $ 点的函数值 $f(z_0)=0 $，则称 $z_0 $ 为 复变函数 $f(z) $ 的零点。

### 复变函数的奇点

若复变函数 $f(z) $ 在 $z_0 $ 点**不解析**，即 $f(z) $ 在 $z_0 $ 点的导数不存在或不唯一，则称 $z_0 $ 为复变函数 $f(z) $ 的奇点。

### 奇点的分类

#### 孤立奇点

若 $z_0$ 为函数 $f(z)$ 的奇点，而在 $z_0$ 点任意小的邻域内，函数 $f(z)$ 解析，则称 $z_0$ 为 $f(z)$ 的孤立奇点。

#### 非孤立奇点

若 $z_0$ 为函数 $f(z)$ 的奇点，而在 $z_0$ 点任意小的邻域内，除 $z_0 $ 点外存在 $f(z) $ 的其他奇点，则称 $z_0$ 为 $f(z)$ 的非孤立奇点。

#### 孤立奇点的分类

**极点**：设 $z_0$ 是 $f(z)$ 的孤立奇点，若存在一个正整数 $k$，使得 $(z-z_0)^kf(z)$ 为非零的解析函数，则称 $z_0$ 为 $f(z)$ 的 $k$ 阶极点。

**本性奇点**：设 $z_0$ 是 $f(z)$ 的孤立奇点，若**不存在**一个正整数 $k$，使得 $(z-z_0)^kf(z)$ 为非零的解析函数，则称 $z_0$ 为 $f(z)$ 的本性奇点。

**可去奇点**：设 $z_0$ 为函数 $f(z)$ 的孤立奇点，$f(z)$ 在 $z_0$ 点没有定义，但在 $z_0$ 的去心邻域内解析，此时可定义 $f(z_0)\equiv \lim\limits_{z\to z_0} f(z)$ 使 $f(z)$ 在 $z_0$ 点解析，则称 $z_0$ 为 $f(z)$ 的可去奇点。

### 解析函数的洛朗展开定理

若函数 $f(z)$ 在以 $z_0$ 为圆心，半径为 $R_1,R_2$ 的两个圆周 $C_1,C_2$ 所包围的环形区域 $R_2<|z-z_0|<R_1$ 上解析，则在此区域内 $f(z)$ 可展成 Laurent 级数：

$$
f(z)
=\sum_{n=-\infty}^{\infty}a_n(z-z_0)^n
$$

其中，

$$
a_n
=\frac{1}{2\pi \mathrm{i}}
\oint\limits_{C^+}\frac{f(\zeta)}{(\zeta-z_0)^{n+1}}\mathrm{d}\zeta
$$

$C$ 是任一条在环形区域内把 $C_2$ 包围在内的闭曲线。

### 例题

#### 例1

> 求 $\displaystyle{f(z)=\frac{1 }{z(z-1) }  }$ 在环形区域 $0<|z|<1 $ 和 $|z|>1 $ 内，在 $z_0=0 $ 处的展开式。

$0<|z|<1$ 区域在 $z_0=0 $ 处展开 $f(z) $：

由于 $|z|<1 $，于是有几何级数：

$$
\frac{1 }{1-z } 
=\sum_{n=0}^{\infty} z^n
$$

于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=-\frac{1}{1-z}-\frac{1}{z} \\
&=-\sum_{n=0}^{\infty} z^n-z^{-1} \\
&=-\sum_{n=-1}^{\infty} z^n \\
\end{aligned} 
$$

$|z|>1$ 区域在 $z_0=0 $ 处展开 $f(z) $：

注意到 $|z|>1 $，则 $|1/z|<1 $，于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=\frac{1}{z(1-\frac{1}{z})}-z^{-1} \\
&=\frac{1}{z}\cdot \frac{1}{1-\frac{1}{z}} -z^{-1} \\
&=\frac{1}{z}\sum_{n=0}^{\infty} \left(\frac{1}{z}\right)^{n}-z^{-1} \\
&=\sum_{n=0}^{\infty} z^{-n-1}-z^{-1} \\
&=\sum_{n=1}^{\infty} z^{-n-1}
\end{aligned}
$$

#### 例2

> 求 $\displaystyle{f(z)=\frac{1 }{z(z-1) }  }$ 在 $z_1=0 $ 和 $z_2=1 $ 附近的展开式。

$f(z) $ 在 $z_1=0$ 附近的展开式：

由于 $0<|z-0|<1 $，于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=-\frac{1}{1-z}-z^{-1} \\
&=-\sum_{n=0}^{\infty} z^n-z^{-1} \\
&=\sum_{n=-1}^{\infty} -z^n \\
\end{aligned} 
$$

$f(z) $ 在 $z_2=1$ 附近的展开式：

由于 $0<|z-1|<1 $，于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=(z-1)^{-1} - \frac{1 }{1-(1-z) } \\
&=(z-1)^{-1} - \sum_{n=0}^{\infty} (1-z)^n \\
&=(z-1)^{-1} - \sum_{n=0}^{\infty} \left(-1 \right)^n (z-1)^n \\
&=(z-1)^{-1} + \sum_{n=0}^{\infty} \left(-1 \right)^{n+1} (z-1)^n \\
&=\sum_{n=-1}^{\infty} \left(-1 \right)^{n+1} (z-1)^n
\end{aligned}
$$

# 第8章 留数定理及其在实积分中的应用

## 留数定理

### 留数的定义

设 $z_0$ 是函数 $f(z)$ 的孤立奇点，设 $f(z)$ 在其孤立奇点 $z_0$ 附近的环形区域中的洛朗展开式为：

$$
f(z)
=\sum\limits_{n=-\infty}^{\infty} a_n(z-z_0)^n
$$

$f(z)$ 在 $z_0$ 点的留数，记为 $\mathrm{Res}f(z_0)$，定义为：

$$
\mathrm{Res} f(z_0)
\equiv a_{-1}
$$

其中，$a_{-1}$ 是 $f(z)$ 在 $z_0$ 点的洛朗展开式中 $(z-z_0)^{-1}$ 项的系数

### 留数的求法

#### 定义法

直接把 $f(z)$ 在其孤立奇点 $z_0$ 点作洛朗展开，找到 $(z-z_0)^{-1}$ 前的系数 $a_{-1}$，由留数的定义可知：

$$
\mathrm{Res} f(z_0)\equiv a_{-1}
$$


#### 极限法

当 $z_0$ 为 $f(z)$ 的 $m$ 阶极点时，$f(z)$ 可在其孤立奇点 $z_0$ 点作如下的洛朗展开：

$$
f(z)
=\sum_{n=-m}^{\infty} a_n(z-z_0)^n,~~a_{-m}\ne 0
$$

则：

$$
\mathrm{Res}f(z_0)
=\frac{1}{(m-1)!}\lim_{z\to z_0}\frac{\mathrm{d}^{m-1}}{\mathrm{d}z^{m-1}}[(z-z_0)^mf(z)]
$$

#### 特殊情况

若 $f(z)=\frac{h(z)}{g(z)},z_0$ 为 $g(z)$ 的一阶极点，即 $g(z_0)=0$，且 $h(z)$ 和 $g(z)$ 在 $z_0$ 点及其邻域内解析，则：

$$
\mathrm{Res}
f(z_0)
=\frac{h(z_0)}{g'(z_0)}
$$

### 留数定理

若 $f(z)$ 在回路 $C$ 所包围的区域内除有限个孤立奇点 $z_1,z_2,\cdots,z_k$ 外解析，则 $f(z)$ 沿 $C^+$ 的回路积分值等于 $f(z)$ 在 $z_1,z_2,\cdots,z_k$ 的留数之和乘 $2\pi\mathrm{i}$，即：

$$
\oint\limits_{C^+} f(z)\mathrm{d}z
=2\pi\mathrm{i}\sum\limits_{j=1}^{k} \mathrm{Res} f(z_j)
$$

#### 例1

> 计算回路积分 $\displaystyle{I=\oint\limits_{l^+} \frac{\mathrm{d}z}{(z^2+1)(z-1)^2} }$ ，其中回路 $l$ 的方程为 $x^2+y^2-2x-2y=0$

令 $\displaystyle{f(z)=\frac{1}{(z^2+1)(z-1)^2}=\frac{1}{(z+\mathrm{i})(z-\mathrm{i})(z-1)^2}  }$ 

在回路 $\displaystyle{l:(x-1)^2+(y-1)^2=\sqrt{2} }$ 内的孤立奇点有：$z_1=\mathrm{i},z_2=1$，$z_1$ 为一阶极点，$z_2$ 为二阶极点。

计算 $f(z) $ 在回路内孤立奇点处的留数：

$$
\begin{aligned}
\mathrm{Res} f(z_1)
&=\frac{1}{0!}\lim_{z\to \mathrm{i}}\frac{\mathrm{d}^0}{\mathrm{d}z^0} (z-\mathrm{i})\cdot\frac{1}{(z+\mathrm{i})(z-\mathrm{i})(z-1)^2} \\
&=\lim_{z\to \mathrm{i}} \frac{1 }{(z+\mathrm{i})(z-1)^2 }  \\
&=\frac{1 }{2\mathrm{i}(\mathrm{i}-1)^2 }  \\
&=\frac{1}{4}
\end{aligned}
$$

$$
\begin{aligned}
\mathrm{Res}f(z_2)
&=\frac{1}{1!}\lim_{z\to 1} \frac{\mathrm{d}^1}{\mathrm{d}z^1}(z-1)^2\cdot\frac{1}{(z+\mathrm{i})(z-\mathrm{i})(z-1)^2} \\
&=\lim_{z\to 1} \frac{\mathrm{d} }{\mathrm{d}z } \left(\frac{1 }{z^2+1 } \right) \\
&=\lim_{z\to 1} \frac{-2z }{\left(z^2+1 \right)^2 }  \\
&=-\frac{1}{2}
\end{aligned}
$$

于是：

$$
\begin{aligned}
I
&=\oint\limits_{l} \frac{\mathrm{d}z}{(z^2+1)(z-1)^2} \\
&=2\pi\mathrm{i}\left[\mathrm{Res}f(z_1)+\mathrm{Res}f(z_2)\right] \\
&=2\pi\mathrm{i}\left(\frac{1 }{4 } - \frac{1 }{2 } \right) \\ 
&=-\frac{\pi\mathrm{i}}{2}
\end{aligned}
$$

## 留数定理在实积分中的应用

### 计算无穷限奇异积分的柯西主值

### 利用 Jordan 引理计算一类带有三角函数的实积分问题

### 计算一类被积函数为有理三角函数式的实积分

考虑如下形式的积分：

$$
I
=\int_{0}^{2\pi} f(\cos\theta,\sin\theta)\mathrm{d}\theta
$$

其中，$f(\cos\theta,\sin\theta) $ 为不包含有孤立奇点 $\cos\theta $ 和 $\sin\theta $ 的有理函数。

计算此类积分，利用欧拉公式换元，将实积分转换为复平面单位圆上的复积分，最后利用留数定理计算积分。

令 $z=\mathrm{e}^{\mathrm{i}\theta} $，有：

$$
z
=\cos\theta+\mathrm{i}\sin\theta,~~
z^{-1}
=\mathrm{e}^{-\mathrm{i}\theta}
=\cos\theta-\mathrm{i}\sin\theta 
$$

于是：

$$
\cos\theta = \frac{z+z^{-1} }{2 },~~
\sin\theta = \frac{z-z^{-1} }{2\mathrm{i} }  
$$

$$
\mathrm{d}z
=\mathrm{i}\mathrm{e}^{\mathrm{i}\theta}\mathrm{d}\theta
=\mathrm{i}z\mathrm{d}\theta
$$

$$
\mathrm{d}\theta
=\frac{\mathrm{d}z }{\mathrm{i}z } 
$$

于是：

$$
\begin{aligned}
I
&=\int_{0}^{2\pi} f(\cos\theta,\sin\theta)\mathrm{d}\theta \\
&=\oint\limits_{C^+} f\left(\frac{z+z^{-1} }{2 },\frac{z-z^{-1} }{2\mathrm{i} } \right) \frac{1 }{\mathrm{i}z }\mathrm{d}z 
\end{aligned}
$$

其中，$C $ 是以复平面原点为圆心的单位圆周，即 $C:|z|=1 $

#### 例1

> 计算定积分 $\displaystyle{I=\int_{0}^{2\pi} \frac{\mathrm{d}\theta }{1+\varepsilon\cos\theta }  }$，其中 $0<\varepsilon<1 $

令：

$$
z = \mathrm{e}^{\mathrm{i}\theta},~~
z^{-1} = \mathrm{e}^{-\mathrm{i}\theta},~~
\mathrm{d}z = \mathrm{i}\mathrm{e}^{\mathrm{i}\theta} \mathrm{d}\theta \Longrightarrow \mathrm{d}\theta = \frac{\mathrm{d}z }{\mathrm{i}\mathrm{e}^{\mathrm{i}\theta} } = \frac{\mathrm{d}z }{\mathrm{i}z },~~
\cos\theta = \frac{1 }{2 }\left(z+z^{-1} \right)   
$$

于是：

$$
\begin{aligned}
I
&=\int_{0}^{2\pi}\frac{\mathrm{d}\theta}{1+\varepsilon\cos\theta} \\
&=\frac{2}{\mathrm{i}}\oint\limits_{C^+} \frac{1}{\varepsilon z^2+2z+\varepsilon}\mathrm{d}z
\end{aligned}
$$

其中，$C$ 是复平面上以原点为圆心的单位圆。

令 $\displaystyle{f(z)=\frac{1}{\varepsilon z^2+2z+\varepsilon} }$ ，被积函数的两个一阶极点为：

$$
z_1
=\frac{-1+\sqrt{1-\varepsilon^2}}{\varepsilon},~~
z_2
=\frac{-1-\sqrt{1-\varepsilon^2}}{\varepsilon}
$$

被积函数 $f(z)$ 可写为：

$$
f(z)
=\frac{1}{\varepsilon(z-z_1)(z-z_2)}
$$

只有 $z_1$ 在积分回路内。

计算 $f(z) $ 在回路内孤立奇点 $z_1 $ 处的留数：

$$
\begin{aligned}
\mathrm{Res}f(z_1)
&=\frac{1}{0!}\lim_{z\to z_1} \frac{\mathrm{d}^0}{\mathrm{d}z^0} (z-z_1)f(z) \\
&=\lim_{z\to z_1} \frac{1}{\varepsilon(z-z_2)} \\
&=\frac{1}{\varepsilon(z_1-z_2)} \\
&=\frac{1}{2\sqrt{1-\varepsilon^2}}
\end{aligned}
$$

由留数定理，有：

$$
\begin{aligned}
\oint\limits_{C^+} \frac{1}{\varepsilon z^2+2z+\varepsilon}\mathrm{d}z
&=2\pi\mathrm{i}\mathrm{Res}f(z_1) \\
&=2\pi\mathrm{i}\cdot\frac{1}{2\sqrt{1-\varepsilon^2}} \\
&=\frac{\pi\mathrm{i}}{\sqrt{1-\varepsilon^2}}
\end{aligned}
$$

于是积分为：

$$
\begin{aligned}
I
&=\frac{2}{\mathrm{i}}\oint\limits_{C^+} \frac{1}{\varepsilon z^2+2z+\varepsilon}\mathrm{d}z \\
&=\frac{2}{\mathrm{i}}\cdot\frac{\pi \mathrm{i}}{\sqrt{1-\varepsilon^2}} \\
&=\frac{2\pi}{\sqrt{1-\varepsilon^2}}
\end{aligned}
$$

#### 例2

> 计算定积分：$\displaystyle{I=\int_{0}^{2\pi} \frac{1}{3-2\cos\theta+\sin\theta}\mathrm{d}\theta }$

$$
z = \mathrm{e}^{\mathrm{i}\theta},~~
z^{-1} = \mathrm{e}^{-\mathrm{i}\theta},~~
\mathrm{d}z = \mathrm{i}\mathrm{e}^{\mathrm{i}\theta} \mathrm{d}\theta \Longrightarrow \mathrm{d}\theta = \frac{\mathrm{d}z }{\mathrm{i}\mathrm{e}^{\mathrm{i}\theta} } = \frac{\mathrm{d}z }{\mathrm{i}z },~~
\cos\theta = \frac{1 }{2 }\left(z+z^{-1} \right),~~
\sin\theta = \frac{1 }{2\mathrm{i} } \left(z-z^{-1} \right)
$$

设 $C$ 是复平面上的单位圆，

$$
\begin{aligned}
I
&=\int_{0}^{2\pi} \frac{1}{3-2\cos\theta+\sin\theta}\mathrm{d}\theta \\
&=2\oint\limits_{C^+} \frac{\mathrm{d}z}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}} \\
\end{aligned}
$$

令 $\displaystyle{f(z)=\frac{1}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}} }$ ，$f(z) $ 有两个一阶极点 $z_1=2-\mathrm{i},z_2=\frac{2}{5}-\frac{1}{5}\mathrm{i} $，只有 $z_2$ 在单位圆 $C$ 内。

由于 $z_1,z_2$ 是 $(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}=0$ 的两根，于是 $f(z)$ 可表达为：

$$
f(z)
=\frac{1}{(1-2\mathrm{i})(z-z_1)(z-z_2)}
$$

$f(z)$ 在 $z_2$ 处的留数：

$$
\begin{aligned}
\mathrm{Res} f(z_2)
&=\frac{1}{0!}\lim_{z\to z_2} \frac{\mathrm{d}^0}{\mathrm{d}z^0} (z-z_2)f(z) \\
&=\lim_{z\to z_2} \frac{1 }{(1-2\mathrm{i})(z-z_1) }  \\
&=\frac{1}{(1-2\mathrm{i})(z_2-z_1)} \\
&=\frac{1}{4\mathrm{i}}
\end{aligned}
$$

于是由留数定理，有：

$$
\begin{aligned}
\oint\limits_{C^+} \frac{\mathrm{d}z}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}}
&=2\pi\mathrm{i}\mathrm{Res} f(z_2) \\
&=\frac{\pi}{2}
\end{aligned}
$$

于是：

$$
\begin{aligned}
I
&=2\oint\limits_{C^+} \frac{\mathrm{d}z}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}} \\
&=2\cdot\frac{\pi}{2} \\
&=\pi
\end{aligned}
$$

# 第9章 傅里叶变换

## 傅里叶级数

设 $\mathcal{H}$ 是一个希尔伯特空间，其元素是周期为 $2l$ 的单变量函数，$\forall f_1,f_2\in \mathcal{H}$，$\mathcal{H}$ 上两个元素的内积，记为 $\braket{f_1,f_2} $，定义为：

$$
\langle f_1,f_2\rangle
\equiv \int_{x=-l}^{x=l} f_1^*(x)f_2(x)\mathrm{d}x,~~x\in\R
$$

其中，$x $ 是参数，而内积与参数无关。有时为了指明参数，也将内积写为：

$$
\braket{f_1(x),f_2(x)}
\equiv \int_{x=-l}^{x=l} f_1^*(x)f_2(x)\mathrm{d}x
$$

若 $f(x) $ 是实函数，则内积可简化为：

$$
\langle f_1,f_2\rangle
\equiv \int_{x=-l}^{x=l} f_1(x)f_2(x)\mathrm{d}x,~~x\in\R
$$

### 三角函数基的傅里叶级数

容易验证如下结论：

$$
\left\{
\begin{aligned}
&\int_{x=-l}^{x=l} \frac{1}{\sqrt{2l}}\cdot\frac{1}{\sqrt{2l}}\mathrm{d}x
=1 \\
&\int_{x=-l}^{x=l} \frac{1}{\sqrt{2l}}\cdot\frac{1}{\sqrt{l}}\sin \frac{n\pi}{l}x\mathrm{d}x
=0 \\
&\int_{x=-l}^{x=l} \frac{1}{\sqrt{2l}}\cdot\frac{1}{\sqrt{l}}\cos \frac{m\pi}{l} x\mathrm{d}x
=0 \\
&\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}} \sin\frac{n\pi}{l} x\cdot\frac{1}{\sqrt{l}} \sin\frac{m\pi}{l} x\mathrm{d}x
=\delta_{n,m},~~n=1,2,\cdots,m=0,1,2,\cdots \\
&\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}} \sin\frac{n\pi}{l} x\cdot\frac{1}{\sqrt{l}} \cos\frac{m\pi}{l} x\mathrm{d}x
=0,~~n=1,2,\cdots,m=0,1,2,\cdots \\
&\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}} \cos\frac{n\pi}{l} x\cdot\frac{1}{\sqrt{l}} \cos\frac{m\pi}{l} x\mathrm{d}x
=\delta_{n,m},~~n,m=0,1,2,\cdots
\end{aligned}
\right.
$$

函数系 $\displaystyle{\left\{\frac{1}{\sqrt{2l}},~~\frac{1}{\sqrt{l}}\sin\frac{n\pi}{l} x,~~\frac{1}{\sqrt{l}}\cos\frac{m\pi}{l} x;~~n,m=1,2,\cdots\right\} }$  是一个完备的正交归一函数族，它们可作为基矢张成 $\mathcal{H}$。

这个函数系具体写出来是：

$$
\left\{\frac{1}{\sqrt{2l}},\frac{1}{\sqrt{l}}\sin\frac{\pi}{l}x,\frac{1}{\sqrt{l}}\cos\frac{\pi}{l}x,\frac{1}{\sqrt{l}}\sin\frac{2\pi}{l}x,\frac{1}{\sqrt{l}}\cos\frac{2\pi}{l}x,\cdots  \right\}
$$

任意一个周期为 $2l$ 的，满足狄利克雷条件的函数 $f(x)$ 可写成这些基函数的线性组合，即 $f(x) $ 可展成傅里叶级数：

$$
f(x)
=a_0\cdot\frac{1}{\sqrt{2l}}+\sum_{k=1}^{\infty} \left(a_k\cdot\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x+b_k\cdot\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x \right)
$$

为求出线性组合的系数，只需要利用“这组基是正交归一完备的”这一性质，比如：

$$
\begin{aligned}
\Braket{\frac{1 }{\sqrt{l} } \cos\frac{k'\pi }{l } x , f(x)}
&=\Braket{\frac{1 }{\sqrt{l} } \cos\frac{k'\pi }{l } x , a_0\cdot\frac{1}{\sqrt{2l}}+\sum_{k=1}^{\infty} \left(a_k\cdot\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x+b_k\cdot\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x \right)} \\
&=\sum_{k=1}^{\infty} a_k\Braket{\frac{1 }{\sqrt{l} } \cos\frac{k'\pi }{l } x , \frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x} \\
&=\sum_{k=1}^{\infty} a_k \delta_{k',k} \\
&=a_{k'}
\end{aligned}
$$

总之：

$$
a_0
=\Braket{\frac{1}{\sqrt{2l}},f(x)}
=\int_{-l}^{l} \frac{1}{\sqrt{2l}}\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{2l}}\int_{-l}^{l} f(x)\mathrm{d}x
$$

$$
a_k
=\Braket{\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x,f(x)}
=\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{l}}\int_{x=-l}^{x=l} f(x)\cos\frac{k\pi}{l} x\mathrm{d}x
$$

$$
b_k
=\Braket{\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x,f(x)}
=\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{l}}\int_{x=-l}^{x=l} f(x)\sin\frac{k\pi}{l} x\mathrm{d}x
$$

### $\mathrm{e} $ 指数基的傅里叶级数

注意到：

$$
\frac{1}{2\pi}\int_{-\pi}^{\pi} \mathrm{e}^{\mathrm{i}(m-n)x}\mathrm{d}x
=\delta_{m,n}
$$

函数系 $\displaystyle{\left\{\frac{1}{\sqrt{2\pi}}\mathrm{e}^{\mathrm{i}m x},m\in \Z \right\} }$  可作为以 $2\pi$ 为周期的函数为元素的希尔伯特空间 $\mathcal{H}$ 中的一组正交完备归一基矢，以 $2\pi$ 为周期的函数 $f$ 在这组基矢上的展开式为：

$$
f(x)
=\sum_{m=-\infty}^{\infty} C_m\cdot\frac{1}{\sqrt{2\pi}}\mathrm{e}^{\mathrm{i}mx} 
$$

利用正交归一条件：

$$
\begin{aligned}
\Braket{\frac{1 }{\sqrt{2\pi} }\mathrm{e}^{\mathrm{i}n x}, \frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}m x} }
&\equiv \int_{-\infty}^{+\infty} \left(\frac{1 }{\sqrt{2\pi} }\mathrm{e}^{\mathrm{i}n x} \right)^* \cdot \left(\frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}m x} \right)\mathrm{d}x \\
&=\frac{1 }{2\pi } \int_{-\infty}^{+\infty} \mathrm{e}^{\mathrm{i}(m-n)x}\mathrm{d}x \\
&=\delta_{m,n}
\end{aligned}
$$

内积可得系数：

$$
\begin{aligned}
\Braket{\frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}n x}, f(x)}
&=\Braket{\frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}n x}, \sum_{m=-\infty}^{\infty} C_m\cdot\frac{1}{\sqrt{2\pi}}\mathrm{e}^{\mathrm{i}m x} } \\
&=\sum_{m=-\infty}^{\infty} C_m \Braket{\frac{1 }{\sqrt{2\pi} }\mathrm{e}^{\mathrm{i}n x}, \frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}m x} } \\
&=\sum_{m=-\infty}^{\infty} C_m\delta_{m,n} \\
&=C_n
\end{aligned}
$$

即系数 $C_m $ 可通过内积求得：

$$
C_m
=\Braket{\frac{1}{\sqrt{2\pi}} \mathrm{e}^{\mathrm{i}mx},f(x)}
=\int_{-\pi}^{\pi}\left(\frac{1}{\sqrt{2\pi}} \mathrm{e} ^{\mathrm{i}mx}\right)^*\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{2\pi}} \int_{-\pi}^{\pi} f(x) \mathrm{e}^{-\mathrm{i}mx}\mathrm{d}x
$$

## 傅里叶变换(to be continued)

### 傅里叶分解与傅里叶变换


若 $f(x)$ 是定义在 $\R$ 上的实函数，它在任何有限的区间上满足 Dirichlet 条件，且积分 $\displaystyle{\int_{-\infty}^{+\infty} |f(x)|\mathrm{d}x }$  收敛，则 $f(x) $ 可进行**傅里叶分解**（将 $f(x) $ 分解为无穷多不同频率 $k $ 的基函数 $\mathrm{e}^{\mathrm{i}kx} $ 的线性叠加）：

$$
f(x)
=\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k
$$

其中，系数 $C(k) $ 称为 $f(x) $ 的傅里叶变换（或频谱）。

为求出系数 $C(k) $ 的表达式，令 $\mathrm{e}^{\mathrm{i}k'x} $ 与上式两端内积，等式仍成立：

$$
\Braket{\mathrm{e}^{\mathrm{i}k'x} , f(x)}
=\Braket{\mathrm{e}^{\mathrm{i}k'x} , \frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k}
$$

根据内积的定义，分别计算内积：

$$
\begin{aligned}
\Braket{\mathrm{e}^{\mathrm{i}k'x} , f(x)}
&\equiv \int_{x=-\infty}^{x=+\infty} \left(\mathrm{e}^{\mathrm{i}k'x} \right)^* f(x)\mathrm{d}x \\
&\equiv \int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}k'x}\mathrm{d}x \\
\end{aligned}
$$

$$
\begin{aligned}
\Braket{\mathrm{e}^{\mathrm{i}k'x}, \frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k}
&\equiv\int_{x=-\infty}^{x=+\infty} \left(\mathrm{e}^{\mathrm{i}k'x} \right)^*\left(\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k \right) \mathrm{d}x \\
&=\frac{1 }{2\pi } \int_{x=-\infty}^{x=+\infty} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}(k-k')x} \mathrm{d}k\mathrm{d}x \\
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} \int_{x=-\infty}^{x=+\infty} C(k) \mathrm{e}^{\mathrm{i}(k-k')x} \mathrm{d}x\mathrm{d}k \\
&=\int_{k=-\infty}^{k=+\infty} C(k) \left(\frac{1 }{2\pi } \int_{x=-\infty}^{x=+\infty} \mathrm{e}^{\mathrm{i}(k-k')x}\mathrm{d}x \right) \mathrm{d}k \\
&=\int_{k=-\infty}^{k=+\infty} C(k)\delta(k-k')\mathrm{d}k \\
&=C(k')
\end{aligned}
$$

$$
C(k')
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}k'x}\mathrm{d}x
$$

将 $k' $ 替换成 $k $，即：

$$
C(k)
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x
$$


这就得到了 $f(x) $ 的傅里叶分解 $\displaystyle{f(x)=\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k }$ 中系数 $C(k) $ 的表达式。


$$
f(x)
=\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k,~~
C(k)
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x
$$

其中，系数 $C(k) $ 称为 $f(x) $ 的傅里叶变换（或频谱），也记为：

$$
C(k)
\equiv \mathscr{F}\{f(x) \}(k)
$$

也就是说，函数 $f(x) $ 的傅里叶变换 $\mathscr{F}\{f(x)\}(k) $ 是一个关于 $k $ 的函数，其表达式为：

$$
\mathscr{F}\{f(x)\}(k)
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x
$$

### 傅里叶变换的基本性质

#### 线性定理

$$
\mathscr{F}\{\alpha_1 f_1+\alpha_2 f_2\}
=\alpha_1\mathscr{F}\{f_1\}+\alpha_2 \mathscr{F}\{f_2\}
$$

#### 延迟定理

$$
\mathscr{F}\{f(x-x_0)\}(k)
=\mathrm{e}^{-\mathrm{i}kx_0} \mathscr{F}\{f(x)\}(k)
$$

#### 位移定理

设 $\mathscr{F}\{f(x) \}(k) = C(k) $，则：

$$
\mathscr{F}\{f(x)\mathrm{e}^{\mathrm{i}k_0 x}\}(k)
=C(k-k_0)
$$

#### 标度变换定理

设 $\mathscr{F}\{f(x) \}(k) = C(k) $，则：

$$
\mathscr{F}\{f(ax)\}(k)
=\frac{1}{|a|}C\left(\frac{k}{a}\right)
$$

#### 微分定理

设当 $|x|\to\infty$ 时，$f(x)\to 0$，则有：

$$
\mathscr{F}\{f'(x)\}(k)
=\mathrm{i}k \mathscr{F}\{f(x)\}(k)
$$

$$
\mathscr{F}\{f^{(n)}(x)\}(k)
=(\mathrm{i}k)^n \mathscr{F}\{f(x)\}(k)
$$

#### 卷积定理

$$
f_1(x)*f_2(x)
\equiv \int_{-\infty}^{+\infty} f_1(x-\xi) f_2(\xi)\mathrm{d}\xi
$$

$$
\mathscr{F}\{f_1(x)*f_2(x)\}(k)
=\mathscr{F}\{f_1(x)\}(k)\mathscr{F}\{f_2(x)\}(k)
$$


# 第10章 拉普拉斯变换

## 拉普拉斯变换的定义

对于定义在实变数 $t\in[0,+\infty)$ 上的实函数或复函数 $f(t)$，定义 $f(t)$ 的拉普拉斯变换为： 

$$
\mathcal{L}\{f(t)\}(p)
\equiv F(p)
\equiv \int_{t=0}^{t=+\infty} f(t)\mathrm{e}^{-p t} \mathrm{d}t
$$

其中，$p=s+\mathrm{i}\sigma,s\in \R,\sigma\in \R$
，$\mathrm{e}^{-pt}$ 称为拉普拉斯变换核，$F(p) $ 称为像函数，也记为：

$$
F(p) \risingdotseq f(t),~~f(t) \fallingdotseq F(p)  
$$

## 拉普拉斯变换的性质（两种记号）

### 线性定理

若 $\alpha_1,\alpha_2\in \mathbb{C}$，则：

$$
\mathcal{L}\{ \alpha_1f_1(t)+\alpha_2f_2(t) \}(p)
=\alpha_1\mathcal{L}\{ f_1(t) \}(p)+\alpha_2\mathcal{L}\{ f_2(t) \}(p)
$$

---

设 $f_1(t)\fallingdotseq F_1(p),f_2(t)\fallingdotseq F_2(p)$，则：

$$
\alpha_1 f_1(t)+\alpha_2 f_2(t)
\fallingdotseq \alpha_1F_1(p)+\alpha_2F_2(p)
$$ 

### 延迟定理

设 $\tau>0 $，则：

$$
\mathcal{L}\{ f(t-\tau)H(t-\tau) \}(p)
=\mathrm{e}^{-\tau p}\mathcal{L}\{ f(t) \}(p)
$$

***

设 $f(t)\fallingdotseq F_(p),\tau>0 $，则：

$$
f(t-\tau)H(t-\tau)\fallingdotseq \mathrm{e}^{-p\tau}F(p)
$$

其中，定义了阶跃函数 $H $:

$$
H(t)
\equiv\begin{cases}
1&,t>0 \\
0&,t\leqslant 0
\end{cases}
$$ 

### 位移定理

设 $\lambda\in \mathbb{C} $，则：

$$
\mathcal{L}\left\{\mathrm{e}^{-\lambda t} f(t) \right\}(p)
=\mathcal{L}\{f(t) \} (p+\lambda)
$$

___

设 $f(t)\fallingdotseq F(p),\lambda\in\mathbb{C} $，则：

$$
\mathrm{e}^{-\lambda t}f(t)
\fallingdotseq F(p+\lambda)
$$

### 标度变换定理

设 $a>0 $，则：

$$
\mathcal{L}\{f(at) \}(p)
=\frac{1 }{a } \mathcal{L}\{f(t) \}\left(\frac{p }{a }  \right)
$$

---

设 $f(t)\fallingdotseq F(p) $，则：

$$
f(at)
\fallingdotseq \frac{1}{a}F\left(\frac{p}{a}\right),a>0
$$

### 卷积定理

$$
\mathcal{L}\{ f_1(t)*f_2(t) \}(p)
=\mathcal{L}\{ f_1(t) \}(p)\cdot\mathcal{L}\{ f_2(t) \}(p)
$$

其中，卷积的定义为：

$$
f_1(t)*f_2(t)
\equiv \int_{\tau=0}^{\tau=t} f_1(\tau)f_2(t-\tau)\mathrm{d}\tau 
$$

---

设 $f_1(t)\fallingdotseq F_1(p),f_2(t)\fallingdotseq F_2(p) $，则：

$$
f_1(t)*f_2(t)
\fallingdotseq F_1(p)F_2(p)
$$

### 微分定理

$$
\mathcal{L}\left\{ f^{(n)}(t) \right\}(p)
=p^n \mathcal{L}\{ f(t) \}(p)-p^{n-1}f^{(0)}(0)-p^{n-2}f^{(1)}(0)-\cdots-p^{1}f^{(n-2)}(0)-p^0\cdot f^{(n-1)}(0)
$$

---

设 $f(t)\fallingdotseq F(p) $，则：

$$
f^{(n)}(t)
\fallingdotseq p^n F(p)-p^{n-1}f^{(0)}(0)-p^{n-2}f^{(1)}(0)-\cdots-p^{1}f^{(n-2)}(0)-p^{0}f^{(n-1)}(0)
$$

特别地：

$$
f^{(1)}(t)
\fallingdotseq p^1 F(p)-p^0 f^{(0)}(0)
$$

$$
f^{(2)}(t)
\fallingdotseq p^2 F(p)-p^1f^{(0)}(0)-p^0f^{(1)}(0)
$$

### 积分性质

$$
\mathcal{L}\bigg\{ \underbrace{\int_{0}^{t}\mathrm{d}t\int_{0}^{t}\mathrm{d}t\cdots \int_{0}^{t}\mathrm{d}t}_{n重积分} f(t)\bigg\}(p)
=\frac{1}{p^n}\mathcal{L}\{ f(t) \}(p)
$$

---

$$
\underbrace{\int_{0}^{t}\mathrm{d}t\int_{0}^{t}\mathrm{d}t\cdots \int_{0}^{t}\mathrm{d}t}_{n重积分} f(t)
\fallingdotseq \frac{1 }{p^n } \mathcal{L}\{f(t) \}(p)
$$

### 周期函数变换定理

若 $f(t)=f(t+T)$，则：

$$
\mathcal{L}\{f(t) \}(p)
=\frac{\int_{0}^{T}f(\tau)\mathrm{e}^{-p\tau}\mathrm{d}\tau}{1-\mathrm{e}^{-pT}}
$$

---

若 $f(t)=f(t+T)$，则：

$$
f(t)
\fallingdotseq \frac{\int_{0}^{T}f(\tau)\mathrm{e}^{-p\tau}\mathrm{d}\tau}{1-\mathrm{e}^{-pT}}
$$

## 常用拉普拉斯变换及反演

$$
\mathcal{L}\{1\}(p)
=\frac{1}{p},~~\mathrm{Re}~p>0
$$

$$
\mathcal{L}\{ e^{at} \}(p)
=\frac{1}{p-a},~~\mathrm{Re}~p>a
$$

$$
\mathcal{L}\{ t^n \}(p)
=\frac{\Gamma(n+1)}{p^{n+1}}
$$

$$
\mathcal{L}\{ t^n e^{at} \}(p)
=\frac{\Gamma(n+1)}{(p-a)^{n+1}}
$$

$$
\mathcal{L}\{ \sin at \}(p)
=\frac{a}{p^2+a^2}
$$

$$
\mathcal{L}\{ \cos at \}(p)
=\frac{p}{p^2+a^2}
$$

$$
\mathcal{L}\{ \sinh at \}(p)
=\frac{a}{p^2-a^2}
$$

$$
\mathcal{L}\{ \cosh at \}(p)
=\frac{p}{p^2-a^2}
$$

$$
\mathcal{L}\{ t\sin at \}(p)
=\frac{2ap}{(p^2+a^2)^2}
$$

$$
\mathcal{L}\{ t\cos at \}(p)
=\frac{p^2-a^2}{(p^2+a^2)^2}
$$

---

$$
\frac{1}{p}
\risingdotseq 1,~~
\frac{1}{p^2}
\risingdotseq t,~~
\frac{n!}{p^{n+1}}
\risingdotseq t^n \\[1mm]
\frac{1}{p-\alpha}
\risingdotseq \mathrm{e}^{\alpha t},~~
\frac{n!}{(p-n)^{n+1}}
\risingdotseq t^n\mathrm{e}^{\alpha t} \\[1mm]
\frac{\alpha}{p^2+\alpha^2}
\risingdotseq \sin\alpha t,~~
\frac{p}{p^2+\alpha^2}
\risingdotseq \cos\alpha t \\[1mm]
\frac{\alpha}{p^2-\alpha^2}
\risingdotseq \sinh\alpha t,~~
\frac{p}{p^2-\alpha^2}
\risingdotseq \cosh\alpha t
$$

## 拉普拉斯变换的应用

### 解常微分方程

#### 例1

> 用拉普拉斯变换解下列 $RL $ 串联电路方程，其中 $L,R,E $ 为常数：
>
>$$
\left\{
\begin{aligned}
&L\frac{\mathrm{d}i(t) }{\mathrm{d}t } + R i(t) = E \\
&i(0) = 0 
\end{aligned}
\right.
>$$

设 $i(t)\fallingdotseq F(p) $

微分定理给出：

$$
\frac{\mathrm{d}i(t) }{\mathrm{d}t }
\fallingdotseq p^1 F(p) - p^0 i^{(0)}(0)
=pF(p) - i(0)
=pF(p)
$$

常用拉普拉斯变换：

$$
\mathcal{L}\{1 \}(p)
=\frac{1 }{p } ,~~\mathrm{Re}~p>0,~~\mathrm{or} 1\fallingdotseq \frac{1 }{p } 
$$

对方程 $\displaystyle{L\frac{\mathrm{d}i(t) }{\mathrm{d}t } = +R i(t) = E }$ 两边同时作拉普拉斯变换，得：

$$
L p F(p) + R F(p) = \frac{E }{p } 
$$

解出 $F(p) $：

$$
\begin{aligned}
F(p)
&=\frac{E }{Lp^2 + Rp } \\
&=\frac{E }{R } \left(\frac{1 }{p } - \frac{p }{p+R/L }  \right) 
\end{aligned}
$$

常用拉普拉斯变换的反演：

$$
\frac{1 }{p-\alpha } \risingdotseq \mathrm{e}^{\alpha t}
$$

于是：
$$
\frac{1 }{p } \risingdotseq 1,~~\frac{1 }{p+R/L } \risingdotseq \mathrm{e}^{-\frac{R }{L } t}
$$

对方程 $\displaystyle{F(p) = \frac{E }{R } \left(\frac{1 }{p } - \frac{p }{p+R/L } \right) }$ 两边同时作拉普拉斯逆变换，得：

$$
i(t)
=\frac{E }{R } \left(1-\mathrm{e}^{-\frac{R }{L } t} \right)
$$

# 第11章 $\delta$ 函数

## $\delta$ 函数的定义

$\delta$ 函数是一个定义在 $\R$ 上的广义函数，其满足：

$$
\delta(x-x_0)
=\begin{cases}
0&,x\ne x_0 \\
+\infty&, x=x_0 
\end{cases},
且
\int_a^b\delta (x-x_0)\mathrm{d}x
=\begin{cases}
1&,x_0\in(a,b) \\
0&,x_0\notin (a,b)
\end{cases}
$$

## $\delta$ 函数的性质

（1）设 $f(x)$ 为连续函数，则：

$$
\int_{-\infty}^{+\infty} f(x)\delta(x-x_0) \mathrm{d}x
=f(x_0)
$$

（2）$\delta(x)$ 是偶函数：

$$
\delta(-x)
=\delta(x)
$$

（3）：

$$
f(x)\delta(x-x_0)
=f(x_0)\delta(x-x_0)
$$

（4）：

$$
x\delta(x)
=0
$$

（5）：

$$
\int_{-\infty}^{+\infty} \delta(x-x_2)\delta(x-x_1)\mathrm{d}x
=\delta(x_1-x_2)
$$

（6）：设 $\{x_i\}$ 为 $\varphi(x)$ 的单根，即 $\varphi(x_i)=0 $ 且 $\varphi'(x_i)\ne 0 $，则：

$$
\delta(\varphi(x))
=\sum_{i}\frac{1}{|\varphi'(x_i)|}\delta(x-x_i)
$$

简单例子：

$$
\delta(ax)
=\frac{1 }{|a| } \delta(x)
$$

$$
\delta(x^2-a^2)
=\frac{1 }{2|a| } \left[ \delta(x+a) + \delta(x-a) \right]
$$

## 三维 $\delta$ 函数

$$
\delta(\vec{r}-\vec{r}_0)
=\begin{cases}
0&,\vec{r}\ne\vec{r}_0 \\
+\infty&,\vec{r}=\vec{r}_0
\end{cases},且
\int\limits_{V}\delta(\vec{r}-\vec{r}_0)\mathrm{d}^3\vec{r}
=1,
\vec{r}_0\in V
$$

### 三维直角坐标系

$$
\mathrm{d}^3\vec{r}
=\mathrm{d}x\mathrm{d}y\mathrm{d}z
$$

$$
\delta(\vec{r}-\vec{r}_0)
\equiv \delta(x-x_0)\delta(y-y_0)\delta(z-z_0)
$$

### 三维球坐标系

$$
\mathrm{d}^3\vec{r}
=r^2\sin\theta\mathrm{d}r\mathrm{d}\theta\mathrm{d}\varphi
$$

$$
\delta(\vec{r}-\vec{r}_0)
=\frac{1}{r^2\sin\theta}\delta(r-r_0)\delta(\theta-\theta_0)\delta(\varphi-\varphi_0)
$$

### 三维柱坐标系

$$
\mathrm{d}^3\vec{r}
=\rho\mathrm{d}\rho\mathrm{d}\varphi\mathrm{d}z
$$

$$
\delta(\vec{r}-\vec{r}_0)
=\frac{1}{\rho}\delta(\rho-\rho_0)\delta(\varphi-\varphi_0)\delta(z-z_0)
$$

## 不同形式的 $\delta $ 函数

$$
\delta(x)
=\lim_{n\to\infty} \sqrt{\frac{n }{\pi } }\mathrm{e}^{-nx^2}
$$

$$
\delta(\vec{r})
=-\frac{1}{4\pi}\nabla^2\frac{1}{r}
$$

## $\delta$ 函数的傅里叶展式和傅里叶变换

### 一维

设 $\delta(x-x_0) $ 可展为：

$$
\delta(x-x_0)
=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} C(k)\mathrm{e}^{\mathrm{i}kx}\mathrm{d}k
$$

其中，系数 $C(k) $ 就是 $\delta(x-x_0) $ 的傅里叶变换 $\mathscr{F}\{\delta(x-x_0) \}(k) $，即：

$$
\begin{aligned}
C(k)
&=\mathscr{F}\{\delta(x-x_0) \}(k) \\
&=\int_{k=-\infty}^{k=+\infty}\delta(x-x_0)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x \\
&=\mathrm{e}^{-\mathrm{i}kx_0}
\end{aligned}
$$

代回 $\delta(x-x_0) $ 的傅里叶展式，可得：

$$
\begin{aligned}
\delta(x-x_0)
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} C(k)\mathrm{e}^{\mathrm{i}kx}\mathrm{d}k \\
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} \mathrm{e}^{-\mathrm{i}kx_0} \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k \\
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} \mathrm{e}^{\mathrm{i}k(x-x_0)}\mathrm{d}k
\end{aligned}
$$

$$
\boxed{
\delta(x-x_0)
=\frac{1}{2\pi}\int_{k=-\infty}^{k=+\infty} \mathrm{e}^{\mathrm{i}(x-x_0)k}\mathrm{d}k
}
$$

### 三维

$$
\begin{aligned}
\delta(\vec{r}-\vec{r}_0)
&=\delta(x-x_0)\delta(y-y_0)\delta(z-z_0) \\
&=\left(\frac{1}{2\pi}\int_{k_x=-\infty}^{k_x=+\infty} \mathrm{e}^{\mathrm{i}(x-x_0)k_x}\mathrm{d}k_x \right)\left(\frac{1}{2\pi}\int_{k_y=-\infty}^{k_y=+\infty} \mathrm{e}^{\mathrm{i}(y-y_0)k_y}\mathrm{d}k_y \right)\left(\frac{1}{2\pi}\int_{k_z=-\infty}^{k_z=+\infty} \mathrm{e}^{\mathrm{i}(z-z_0)k_z}\mathrm{d}k_z \right) \\
&=\frac{1 }{\left(2\pi \right)^3 } \int_{k_x=-\infty}^{k_x=+\infty} \int_{k_y=-\infty}^{k_y=+\infty} \int_{k_z=-\infty}^{k_z=+\infty} \mathrm{e}^{\mathrm{i}(x-x_0)k_x} \mathrm{e}^{\mathrm{i}(y-y_0)k_y} \mathrm{e}^{\mathrm{i}(z-z_0)k_z} \mathrm{d}k_x \mathrm{d}k_y \mathrm{d}k_z \\
&=\frac{1 }{\left(2\pi \right)^3 } \int\limits_{\vec{k}\in\R^3} \mathrm{e}^{\mathrm{i}(\vec{r}-\vec{r}_0)\cdot\vec{k}}\mathrm{d}^3\vec{k}
\end{aligned}
$$

$$
\boxed{
\delta(\vec{r}-\vec{r}_0)
=\frac{1 }{\left(2\pi \right)^3 } \int\limits_{\vec{k}\in\R^3} \mathrm{e}^{\mathrm{i}(\vec{r}-\vec{r}_0)\cdot\vec{k}}\mathrm{d}^3\vec{k}
}
$$

## 例题

### 例1

> 证明：$\displaystyle{\delta(\vec{r})=-\frac{1}{4\pi}\nabla^2\frac{1}{r} }$ 

当 $\vec{r}\ne \vec{0} $，有：

$$
\nabla \frac{1 }{r }
=-\frac{1 }{r^2 } \nabla r
=-\frac{1 }{r^2 } \frac{\vec{r} }{r } 
=-\frac{\vec{r} }{r^3 }  
$$

$$
\begin{aligned}
\nabla^2\frac{1 }{r } 
&=\nabla\cdot\left(\nabla\frac{1 }{r }  \right) \\
&=\nabla\cdot\left(-\frac{\vec{r} }{r^3 }  \right) \\
&=-\left(\vec{r}\cdot\nabla\frac{1 }{r^3 } + \frac{1 }{r^3 } \nabla\cdot\vec{r} \right) \\
&=-\left(\vec{r}\cdot \left(-3r^{-4} \frac{\vec{r} }{r }  \right) + \frac{1 }{r^3 } \cdot 3 \right) \\
&=0
\end{aligned}
$$

$\displaystyle{\nabla^2\frac{1}{r} }$ 在 $\vec{r}=\vec{0} $ 处无定义，但可人为定义其在 $\vec{0} $ 处的函数值为 $+\infty $

取以坐标原点为球心，半径为 $R $ 的一个球体 $V $，

$$
\begin{aligned}
\int\limits_{\vec{r}\in V} -\frac{1}{4\pi}\nabla^2\frac{1}{r} \mathrm{d}^3\vec{r} 
&=-\frac{1 }{4\pi } \int\limits_{\vec{r}\in V} \nabla\cdot\left(\nabla\frac{1 }{r }  \right)\mathrm{d}^3\vec{r} \\
&=-\frac{1 }{4\pi } \oint\limits_{\partial V^+} \nabla\frac{1 }{r } \cdot\mathrm{d}\vec{S} \\
&=-\frac{1 }{4\pi } \oint\limits_{\partial V^+} -\frac{\vec{r} }{r^3 }  \cdot\mathrm{d}\vec{S} \\
&=\frac{1 }{4\pi }\cdot \frac{1 }{R^2 }  \oint\limits_{\partial V^+} \mathrm{d}S \\
&=\frac{1 }{4\pi R^2 } \cdot 4\pi R^2 \\
&=1
\end{aligned}
$$

# 第12章 小波变换初步

# 第13章 波动方程、输运方程、泊松方程及其定解问题

# 第14章 分离变量法

# 第15章 曲线坐标系下的分离变量

# 第16章 球函数

# 第17章 柱函数

# 第18章 格林函数法

# 第19章 其他方程求解

# 第20章 非线性数学物理方程初步

# 第21章 泛函的变分

# 第22章 变分原理